{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": 700,
  "height": 500,
  "title": "Top 100 YouTube Channels",
  "data": {
    "url": "data/global-youtube-statistics.csv",
    "format": {"type": "csv"}
  },
  "transform": [
    {"filter": "datum.subscribers > 0 && datum['video views'] > 0"},
    {
      "calculate": "datum.category == null || datum.category == 'nan' ? 'Misc' : datum.category",
      "as": "category_clean"
    }
  ],
  "selection": {
    "zoom": {"type": "interval", "bind": "scales"},
    "categoryHighlight": {
      "type": "multi",
      "fields": ["category_clean"],
      "bind": "legend",
      "empty": "all"
    },
    "reset": {"type": "single", "fields": [], "on": "dblclick", "empty": "all"}
  },
  "encoding": {
    "x": {
      "field": "subscribers",
      "type": "quantitative",
      "title": "Subscribers",
      "scale": {"type": "log", "base": 10, "domainMin": 10000000}
    },
    "y": {
      "field": "video views",
      "type": "quantitative",
      "title": "Video Views",
      "scale": {"type": "log", "base": 10, "domainMin": 100000000}
    },
    "color": {
      "field": "category_clean",
      "type": "nominal",
      "title": "Category",
      "scale": {
        "domain": [
          "Music", "Film & Animation", "Entertainment", "Education", "Shows",
          "People & Blogs", "Gaming", "Sports", "Howto & Style", "News & Politics",
          "Comedy", "Trailers", "Nonprofits & Activism", "Science & Technology",
          "Movies", "Pets & Animals", "Autos & Vehicles", "Travel & Events", "Misc"
        ],
        "range": [
          "#FBB4AE", "#B3CDE3", "#CCEBC5", "#DECBE4", "#FED9A6",
          "#FFFFCC", "#E5D8BD", "#B3E2CD", "#FDDAEC", "#CBAACB",
          "#F2F2B0", "#F4CAE4", "#CBD5E8", "#E6F5C9", "#FFDAB9",
          "#BFD3E6", "#F6E8C3", "#CCEBC5", "#D9D9D9"
        ]
      }
    },
    "size": {
      "field": "uploads",
      "type": "quantitative",
      "title": "Uploads",
      "scale": {"type": "sqrt", "range": [20, 400]}
    },
    "opacity": {
      "condition": {"selection": "categoryHighlight", "value": 0.8},
      "value": 0.1
    },
    "tooltip": [
      {"field": "Youtuber", "type": "nominal", "title": "Channel"},
      {"field": "subscribers", "type": "quantitative", "title": "Subscribers", "format": ","},
      {"field": "video views", "type": "quantitative", "title": "Total Views", "format": ","},
      {"field": "uploads", "type": "quantitative", "title": "Uploads", "format": ","},
      {"field": "category_clean", "type": "nominal", "title": "Category"},
      {"field": "Country", "type": "nominal", "title": "Country"}
    ]
  },
  "mark": {"type": "point", "filled": true, "strokeWidth": 0.5}
}
